<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<link rel="manifest" href="manifest.webmanifest">
<title>ãŠã§ã‹ã‘å¤©æ°—ãƒŠãƒ“ï½œãŠæ°—ã«å…¥ã‚Š</title>
<link rel="stylesheet" href="styles.css">
<style>
  .fav-card{display:flex;justify-content:space-between;align-items:center;padding:12px;border-bottom:1px solid #e2e8f0}
  .fav-title{font-weight:700}
  .fav-meta{color:var(--muted);font-size:13px;margin-top:4px}
  .fav-actions{display:flex;gap:8px}
  .danger{background:#fee2e2;border-color:#fecaca}
</style>
</head>
<body>
<header class="top">
  <div class="title">ãŠæ°—ã«å…¥ã‚Š</div>
  <button id="addToHome" class="primary"><span class="icon">+</span> ãƒ›ãƒ¼ãƒ ã«è¿½åŠ </button>
</header>

<main>
  <section class="card">
    <div id="empty" class="note" style="display:none">ãŠæ°—ã«å…¥ã‚Šã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚<br>ã‚¹ãƒãƒƒãƒˆ/ãŸã¹ã‚‹ã®å„ã‚«ãƒ¼ãƒ‰ã«ã‚ã‚‹ <b>â˜†</b> ã‚’æŠ¼ã™ã¨è¿½åŠ ã§ãã¾ã™ã€‚</div>
    <div id="favList"></div>
  </section>
</main>

  <nav class="tabbar">
    <a href="index.html"><span class="icon">â›…</span><span class="label">å¤©æ°—</span></a>
    <a href="spots.html"><span class="icon">ğŸ“</span><span class="label">ã‚¹ãƒãƒƒãƒˆ</span></a>
    <a href="meals.html"><span class="icon">ğŸ½</span><span class="label">ãŸã¹ã‚‹</span></a>
    <a href="favorites.html" class="active"><span class="icon">â­</span><span class="label">ãŠæ°—ã«å…¥ã‚Š</span></a>
  </nav>

<script src="favorites.js"></script>
<script>
(function(){
  function row(item){
    const div = document.createElement('div');
    div.className = 'fav-card';
    const left = document.createElement('div');
    left.innerHTML = `<div class="fav-title">${item.name}</div>
      <div class="fav-meta">${item.kind==='spot'?'ã‚¹ãƒãƒƒãƒˆ':'ãŠåº—'}ï¼ç·¯åº¦${Number(item.lat).toFixed(4)} çµŒåº¦${Number(item.lon).toFixed(4)}</div>`;
    const right = document.createElement('div');
    right.className = 'fav-actions';
    const g = document.createElement('a');
    g.className = 'iconbtn';
    g.textContent = 'G';
    g.href = Favorites.gmapsHref(item.name,item.lat,item.lon);
    g.target = '_blank'; g.rel='noopener'; g.title='Googleãƒãƒƒãƒ—ã§é–‹ã'; g.setAttribute('aria-label','Googleãƒãƒƒãƒ—ã§é–‹ã');
    const a = document.createElement('a');
    a.className = 'iconbtn';
    a.textContent = 'ï£¿';
    a.href = Favorites.amapsHref(item.name,item.lat,item.lon);
    a.target = '_blank'; a.rel='noopener'; a.title='Appleãƒãƒƒãƒ—ã§é–‹ã'; a.setAttribute('aria-label','Appleãƒãƒƒãƒ—ã§é–‹ã');
    const del = document.createElement('button');
    del.className = 'primary danger'; del.textContent = 'å‰Šé™¤';
    del.addEventListener('click', ()=>{
      Favorites.removeFavorite(item);
      render();
    });
    right.append(g,a,del);
    div.append(left,right);
    return div;
  }

  function render(){
    const wrap = document.getElementById('favList');
    const empty = document.getElementById('empty');
    wrap.innerHTML='';
    const list = Favorites.getFavorites();
    if(!list.length){ empty.style.display='block'; return; }
    empty.style.display='none';
    list.sort((a,b)=> (a.name||'').localeCompare(b.name||'', 'ja'));
    list.forEach(x=> wrap.appendChild(row(x)));
  }

  window.addEventListener('load', render);
})();
</script>
</body>
</html>
