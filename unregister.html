<!doctype html><html lang="ja"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Service Worker / キャッシュ解除</title>
<style>body{font-family:system-ui,-apple-system,sans-serif;margin:24px;line-height:1.6} code{background:#f1f5f9;padding:2px 4px;border-radius:4px}</style>
</head><body>
<h1>Service Worker / キャッシュ解除</h1>
<ol>
  <li>このページを開くと、同ドメイン配下のService Workerを<strong>解除</strong>し、キャッシュを<strong>全削除</strong>します。</li>
  <li>終わったら <a href="meals.html">meals.html</a> を開いて確認してください。</li>
</ol>
<pre id="log"></pre>
<script>
(async()=>{
  const log=(m)=>document.getElementById('log').textContent+=(m+"\n");
  try{
    if('serviceWorker' in navigator){
      const regs=await navigator.serviceWorker.getRegistrations();
      for(const r of regs){ await r.unregister(); log("Unregistered: " + (r.scope||'')); }
    }
    if('caches' in window){
      const keys=await caches.keys();
      for(const k of keys){ await caches.delete(k); log("Cache deleted: " + k); }
    }
    log("Done.");
  }catch(e){ log("Error: " + e.message); }
})();
</script>
</body></html>